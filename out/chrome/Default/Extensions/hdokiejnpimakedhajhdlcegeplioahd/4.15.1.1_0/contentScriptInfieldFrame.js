var lpResizeEvent=function(){"use strict";var e,t;function n(){e||(e=setTimeout(function(){e=null,t&&t()},66))}return{attachWindowResizeEvent:function(e){t=e,window.addEventListener("resize",n)},detachWindowResizeEvent:function(){t=null,window.removeEventListener("resize",n)}}}(),LPInfieldFrame=function(){"use strict";var e,t,n,i,o="contentScriptPopup.html";function l(i){if(n)n=!1;else{if(i.iframe&&!i.fieldEl)try{i.fieldEl=$(i.iframe).contents().find("#"+i.id)[0]}catch(e){}if(i){if(e){if(t.id===i.id)return;f("away")}!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(o="betterContentScriptPopup.html"),i.url=o,t=i,e=LPFrame.openFrame({url:o,interfaceDefinition:Interfaces.InfieldPopupInterface}),s(),a(),lpResizeEvent.attachWindowResizeEvent(a),window.addEventListener("click",r,!0),bg.sendLpImprove("newinfieldopen",{source:"formv2",option:i.eventType})}}}function r(e){return(!t||e.target.id!==t.id&&e.target!==t.fieldEl)&&(f("away"),!0)}function f(i){e&&(i&&(n="action"==i,bg.sendLpImprove("newinfieldclose",{source:"formv2",option:i})),window.removeEventListener("click",r),lpResizeEvent.detachWindowResizeEvent(),e&&(e.close(),Topics.publish(Topics.INFIELD_NOTIFICATION_CLOSED)),e=null,t=null)}function s(){e&&e.css({display:"block",position:"absolute",height:"0px"})}function a(n){var i,o=null;if(t.fieldEl&&!LPContentScriptTools.isVisible(t.fieldEl))f();else if(e){(o=function(e){var t=375;!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(t=310);var n={top:0,left:0};if(e){var i={top:0,left:0};e.iframe&&(i=e.iframe.getBoundingClientRect());var o={bottom:parseInt(e.posy),left:parseInt(e.posx),width:e.width};e.fieldEl&&e.fieldEl.getBoundingClientRect?o=e.fieldEl.getBoundingClientRect():e.fieldBox&&(o=e.fieldBox),n.top=window.pageYOffset+i.top+o.bottom,n.left=window.pageXOffset+i.left+o.left+o.width-t,n.left<=0&&(n.left=window.pageXOffset+i.left+o.left-10)}return n}(t)).infieldOffset=360,!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(o.infieldOffset=295),(Math.abs(parseInt(t.posx)-o.left)>10||o.left>o.infieldOffset&&o.left<window.outerWidth)&&(i=o.left<=0?25:o.infieldOffset,e&&e.getInterface().lpInfield.setArrowPosition({position:i})),e.css(o),n&&"function"==typeof n&&n(o),csTop.Topics.publish(Topics.INFIELD_FRAME_POSITION_CHANGED,o)}}return{close:f,show:s,openFrame:function(e){var t,n,o;(i=i||(t=l,n=100,function(){var e=this,i=arguments;clearTimeout(o),o=setTimeout(function(){o=null,t.apply(e,i)},n)}))(e)},resizeFrame:function(t,n){var i,o,l;e&&e.css((o=n,l={},(i=t)&&(l.height=i),o&&(l.width=o),l))},positionFrame:a,fillGeneratedPassword:function(e,t,n){(e==punycode.URLToASCII(document.location.href)||has_same_tld(e,document.location.href))&&populategeneratedpassword(e,t,n)}}}();function LP_keypress_handler(e){"use strict";27!=e.keyCode?9!=e.keyCode||LPInfieldFrame.close("away"):LPInfieldFrame.close("close")}
//# sourceMappingURL=sourcemaps/contentScriptInfieldFrame.js.map
