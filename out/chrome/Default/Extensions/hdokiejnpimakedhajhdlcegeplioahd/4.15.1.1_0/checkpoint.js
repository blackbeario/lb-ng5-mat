var Checkpoint=new checkpoint_lib;function initCheckpoint(){return void 0!==Checkpoint&&null!==Checkpoint||(Checkpoint=new checkpoint_lib),void 0!==Checkpoint&&null!==Checkpoint}function doCheckpoint(){return!g_enable_checkpoint||"undefined"==typeof g_isdebug||!g_isdebug||(initCheckpoint(),Checkpoint.assert.apply(this,arguments))}function checkpoint_lib(){var e=this,n=0,r=0,t=0,i=0;if("undefined"!=typeof Date){i=(new Date).getTime();var a=2,s=1;this.checkpoint=function(e,n,r){return!0},this.init=function(){n=0,r=0,t=0,i=(new Date).getTime(),""},this.reset=function(){e.init()},this.assert=function(){var e=arguments;if("undefined"==typeof g_isdebug||!g_isdebug)return t++,!0;var i=null;return void 0!==e[3]&&"function"==typeof e[3]&&(i=e[3],void 0!==e[4]?i(e[4]):i()),e.length<=0?(r++,i(),!1):void 0!==e[2]&&e[2]?(t++,!0):!0===e[0]?(n++,!0):(r++,void l(a,sprintf("ASSERT FAILED: %s !== true%s",e[0],e[1]?" : "+e[1]:"")))},this.stats=function(){var e;return e=void 0!==new Date(i).toUTCString?new Date(i).toUTCString():parseInt(i/1e3).toString(),l(0,sprintf("Since %s, %d good, %d bad, %d skipped\n",e,n,r,t))},this.getstats=function(){return{good:n,bad:r,skipped:t}},this.validate_share_type=function(n,r){if(!n)return!1;var t=!0;return t=(t=(t=(t=(t=(t=(t=t&&e.assert("string"==typeof n.id,o("id",r)))&&e.assert("string"==typeof n.sharekey,o("sharekey",r)))&&e.assert("string"==typeof n.sharename,o("sharename",r)))&&e.assert(e.in_array(n.readonly,["0","1"]),o("readonly",r)))&&e.assert(e.in_array(n.give,["0","1"]),o("give",r)))&&e.assert("string"==typeof n.sharekeyaes||""===n.sharekeyaes,o("sharekeyaes",r)))&&e.assert(e.in_array(n.associative,[0,"0","1"]),o("associative",r)),void 0!==n.linkedshare&&(t=t&&e.assert(e.in_array(n.linkedshare,["0","1"]),o("linkedshare",r))),t=(t=(t=(t=t&&e.assert("string"==typeof n.key,o("key",r)))&&e.assert("string"==typeof n.decsharename,o("decsharename",r)))&&e.assert(lpdec(n.sharename,n.key)===n.decsharename,d("sharename/decsharename",r)))&&e.assert(AES.hex2bin(lpmdec(n.sharekeyaes,!0))===n.key,d("decrypted sharing key",r))},this.validate_shareinfo_type=function(n,r){if(!n)return!1;var t=!0;return t=(t=(t=(t=(t=(t=(t=t&&e.assert("string"==typeof n.id,o("id",r)))&&e.assert("string"==typeof n.sharekey,o("sharekey",r)))&&e.assert("string"==typeof n.decsharename,o("decsharename",r)))&&e.assert(e.in_array(n.readonly,["0","1"]),o("readonly",r)))&&e.assert(e.in_array(n.give,["0","1"]),o("give",r)))&&e.assert(e.in_array(n.associative,[0,"0","1"]),o("associative",r)))&&e.assert(e.in_array(n.linkedshare,["0","1"]),o("linkedshare",r))},this.in_array=function(e,n){if(void 0===n||null===n)return!1;for(var r=n.length,t=0;t<=r;t++)if(void 0!==n[t]&&n[t]===e)return lpArrayOffset=t,!0;return!1},this.validate_fieldinfo=function(e,n){if(!e)return!1;n||(n={});var r=!0;for(var t in n.save_all&&!0,null!==e.name&&"string"==typeof e.name||(console_warn("FAIL: field.name"),r=!1),null!==e.type&&("string"==typeof e.type||lp_in_array(e.type,["text","password","button","file","hidden","checkbox","radio","textarea","submit","image","select","select-one"])||lp_in_array(e.type,["color","date","datetime","datetime-local","email","month","number","range","search","tel","time","url","week"]))||(console_warn("FAIL: field.type"),r=!1),"radio"==e.type||"checkbox"==e.type?!0!==e.checked&&!1!==e.checked&&(console_warn("FAIL: field.checked for "+e.type),r=!1):!1!==e.checked&&(r=!1),"1"===e.otherlogin?(""===e.url?(console_warn("FAIL: field.url should be set in addruid case"),r=!1):hex2url(e.url).match(/^https?:\/\//,"i")||(console_warn("FAIL: invalid field.url"),r=!1),""!==e.urid&&"0"!==e.urid||(console_warn("FAIL: field.urid should be set in addurid case"),r=!1),!1!==e.otherfield&&(console_warn("FAIL: field.otherfield must be false in addurid case"),r=!1)):("0"!==e.otherlogin&&""!==e.otherlogin&&(console_warn("FAIL: field.otherlogin [deprecated?]"),r=!1),""!==e.url&&(console_warn("FAIL: field.url should be empty in non-addurid case"),r=!1),"0"!==e.urid&&""!==e.urid&&(console_warn("FAIL: field.urid should be empty in non-addurid case"),r=!1)),!0!==e.otherfield&&!1!==e.otherfield&&(console_warn("FAIL: field.otherfield [deprecated?]"),r=!1),e)e.hasOwnProperty(t)&&(lp_in_array(t,["name","type","value","formname","checked","urid","otherlogin","url","otherfield"])||(console_warn("found an unexpected property in field info: "+t),r=!1));return r}}function o(e,n){return sprintf("%sproperty '%s' is missing or wrong type",n?"["+n+"] ":"",e)}function d(e,n){return sprintf("%sunexpected value of %s was found",n?"["+n+"] ":"",e)}function l(e,n){return n=LPPerl.chomp(n),n,"undefined"!=typeof console&&console&&(e===s?console.warn(n):e===a?console.error(n):console.log(n)),!0}}initCheckpoint();
//# sourceMappingURL=sourcemaps/checkpoint.js.map
