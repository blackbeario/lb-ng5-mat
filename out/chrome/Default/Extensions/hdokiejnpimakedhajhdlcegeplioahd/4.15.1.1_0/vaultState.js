VaultState={},function(){var e=null,t=null,n=null,i=null,o=null,c=null,s=function(e){if(LPTools.getOption(e,"incrementAccountsVersion",!1)){var n=LPTools.getOption(e,"incrementAccountsVersionAmount",1);t+=n}};Topics.get(Topics.INITIALIZED).subscribe(function(){l()}),Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(t){e=t.getID()}),Topics.get(Topics.REQUEST_SUCCESS).subscribe(function(e){s(e.requestSuccessOptions)}),Topics.get(Topics.UPDATE_VAULT_STATE).subscribe(s);VaultState.incrementAccountsVersion=function(){++t},VaultState.setAccountsVersion=function(e){t=e},VaultState.setIdentities=function(e){o=e};var g=function(s){return!!(bg&&bg.get("lploggedin")&&parseInt(bg.get("g_local_accts_version"))>-1&&LPPlatform.loadedPreferences())&&(bg.get("lploggedin"),e=bg.get("g_identity"),t=parseInt(bg.get("g_local_accts_version")),n=bg.get("g_showcredmon"),Topics.get(Topics.LOGIN).publish({fadeIn:void 0===s||s}),clearInterval(c),c=setInterval(function(){!function(){if(bg.get("lploggedin")){if(o&&bg.get("g_identity")!==e){e=bg.get("g_identity");for(var s=0,l=o.length;s<l;++s)e===o[s].getID()&&o[s].enable({reprompt:!1})}var u=parseInt(bg.get("g_local_accts_version"));u>t?(t=u,Topics.get(Topics.REFRESH_DATA).publish(),i=null):t>u?(null===i&&(i=(new Date).getTime()),(new Date).getTime()-i>15e3&&(i=null,t=u)):i=null,n!==bg.get("g_showcredmon")&&(n=bg.get("g_showcredmon"),Topics.get(Topics.REFRESH_PREFERENCES).publish())}else Topics.get(Topics.CLEAR_DATA).publish(),clearInterval(c),c=setInterval(function(){g()},1e3)}()},1e3),!0)},l=function(){g(!1)||(c=setInterval(function(){g()},1e3))}}();
//# sourceMappingURL=sourcemaps/vaultState.js.map
