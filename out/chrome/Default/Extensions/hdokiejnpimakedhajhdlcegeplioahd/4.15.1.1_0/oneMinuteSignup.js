var oneMinuteSignup=function(){var e={normal:"normal",reminder:"reminder"},n=[],t=null,i=null,o=!1,r=null;return{show:s,showWithProvider:function(){"started"!==bg.OmsNotificationPopup.getState()&&(s("normal",function(){var e=bg.get("g_username");if(-1!==e.indexOf("@gmail"))return"Gmail";if(-1!==e.indexOf("@yahoo"))return"Yahoo";if(-1!==e.indexOf("@outlook"))return"Office365";return"Unknown"}()),bg.OmsNotificationPopup.setState("started"))},setOpenTourFn:function(e){t=e},fetchReminders:d,getReminderCount:function(){return n?n.length:0},modes:e};function a(e){var a,s;if(0===e.origin.indexOf(r))if("ShowTour"===e.data.type)t&&!i&&(t(),i=!0);else if("GetApplications"===e.data.type)a=$("#oneminutesignup iframe")[0],s=LPProxy.getAllModelItems().map(function(e){return{url:e._data.url,userName:e._data.unencryptedUsername}}),a.contentWindow.postMessage({type:"SendApplications",applications:s},r);else if("AddSiteToVault"===e.data.type){var l=LPProxy.getGroupByName(e.data.account.group)||new DummyGroup(e.data.account.group,null);(new Account).addFromDialog(e.data.account,l,{source:"vault"})}else if("Collapse"===e.data.type)$("body").removeClass("oneminfull"),$("body").addClass("oneminsmall");else if("Expand"===e.data.type)$("body").removeClass("oneminsmall"),$("body").addClass("oneminfull");else if("Close"===e.data.type)$("body").removeClass("oneminsmall"),$("body").removeClass("oneminfull"),$("#oneminutesignup").empty(),o=!1,$("#showReminders").removeAttr("disabled");else if("ReminderDeleted"===e.data.type){var m=n.filter(function(n){return n.id===e.data.reminder.id})[0];m&&(n.splice(n.indexOf(m),1),0===n.length?$("#reminderCountContainer").hide():($("#reminderCountContainer").show(),$("#reminderCount").text(n.length)))}else"RemindersAdded"===e.data.type&&(bg.set("g_reminders",bg.get("g_reminders").concat(e.data.reminders)),d())}function d(){0===(n=bg.get("g_reminders")).length?$("#reminderCountContainer").hide():($("#reminderCountContainer").show(),$("#reminderCount").text(n.length))}function s(t,i){(bg.get("g_one_minute_signup_enabled")||bg.get("g_onemin_advert_enabled"))&&(o||(t=t||e.normal,bg.get_method_async(function(d){d=d||"Unknown",o=!0,$("#showReminders").attr("disabled","disabled"),$("#inProgressWithSpinner").toggle(),$.ajax({global:!1,type:"GET",dataType:"json",url:LPProxy.getBaseURL()+"lmiapi/clientconfig",success:function(o){var s=document.createElement("iframe");r=o["1minUiBaseUrl"],s.setAttribute("src",r+"/index.html"),s.setAttribute("class","onemin"),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("frameborder","0"),s.style.position="absolute",$(s).load(function(){$("#inProgressWithSpinner").toggle(),t===e.reminder&&s.contentWindow.postMessage({type:"DisplayMode",mode:t,reminders:n,method:d},r),t===e.normal&&s.contentWindow.postMessage({type:"DisplayMode",mode:t,reminders:n,provider:i,method:d},r)}),$("#oneminutesignup").empty(),$("#oneminutesignup").append(s),window.addEventListener("message",a)}})})))}}();
//# sourceMappingURL=sourcemaps/oneMinuteSignup.js.map
