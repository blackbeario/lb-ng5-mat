LPFrame=function(){var e=0,t={},n=null,i=function(e,t){for(var n in t)e.style.setProperty(n,"string"==typeof(i=t[n])?i:"number"==typeof i?i+"px":"","important");var i;return e},r=function(n){var r=++e,o=n.tracking,a=null,s=new LPEventManager,l=[],c=null,u=null,f=n.interfaceDefinition;t[r]=this;var d=getchromeurl(n.url),h=function(){var e=document.createElement("iframe");d.indexOf(":id")>-1?d=d.replace(":id",r):d+=(d.indexOf("?")>-1?"&":"?")+"dialogID="+r,g_isfirefoxsdk?e.setAttribute("lpsrc",d):e.src=d,i(e,{border:"none",position:"relative",height:"100%",width:"100%",visibility:"visible"}),e.setAttribute("scrolling","no"),e.setAttribute("name","LPFrame");var t=document.createElement("div");return i(t,{position:"fixed","z-index":"2147483647",display:"none",width:"100%",height:"100%"}),t.appendChild(e),document.body.appendChild(t),t}();this.close=function(){s.publishEvent("close"),h.parentElement.removeChild(h),window.removeEventListener("resize",this.refreshPosition),window.removeEventListener("scroll",this.refreshPosition),delete t[r]},this.onClose=function(e){s.addEventListener("close",e)},this.css=function(e){i(h,e),this.refreshPosition()};var g=function(e,t,n){if(n){if("string"==typeof n){if(!n.indexOf("%"))throw"trackElement only supports numbers or percentages for translations";n=e[t]*parseInt(n.substring(0,n.indexOf("%")))/100}return n}return 0};this.refreshPosition=function(){if(o){var e=o.element.getBoundingClientRect(),t=e.top,n=e.left;o.frameTranslation&&(t+=g(h,"clientHeight",o.frameTranslation.y),n+=g(h,"clientWidth",o.frameTranslation.x)),o.targetTranslation&&(t+=g(o.element,"clientHeight",o.targetTranslation.y),n+=g(o.element,"clientWidth",o.targetTranslation.x)),i(h,{top:t,left:n})}},this.trackElement=function(e){o=e,window.addEventListener("resize",this.refreshPosition),window.addEventListener("scroll",this.refreshPosition)},this.getInterface=function(){return null===u&&(c=function(e){null===a?l.push(e):LPPlatform.requestFramework.sendRequest({type:"contentScriptRequest",data:e,frameID:a})},u=Interfaces.createInstance(f,{direct:!1,context:"contentScript",requestFunction:c})),u};this.initialize=function(e){if(null===a){var t=function(){for(var e=[],t=document.getElementsByTagName("iframe"),n=0;n<t.length;++n){var i=t[n];i.src!==d&&i.getAttribute("lpsrc")!==d||e.push(i)}return e}();if(!(t.length>1)){a=e;for(var n=0;n<l.length;++n)c(l[n]);return!0}t.forEach(function(e){e.parentElement.removeChild(e)})}return!1},this.getParams=function(){return n.dialogData},this.getDialogID=function(){return r},o&&this.trackElement(o)};Topics.get(Topics.CLEAR_DATA).subscribe(function(){for(var e in t)t[e].close()});var o=function(e){return new r(e)};return{css:function(e){if(e){var n=t[e.id];n&&n.css(e.css)}"function"==typeof e.callback&&e.callback()},close:function(e){var n=t[e];n&&n.close()},openDialog:function(e,t,n){var i=o({url:"contentScriptDialog.html",interfaceDefinition:Interfaces.ContentScriptDialogInterface});return i.getInterface().LPDialog.openDialog(e,t),n&&(n.css&&i.css(n.css),n.callback&&n.callback(i.getDialogID())),i},openAngularDialog:function(e,t,n){var i=o({url:"lastpass/index.html#/sandbox/:id/"+e,dialogData:t});return n&&(n.css&&i.css(n.css),n.callback&&n.callback(i.getDialogID())),i},openFrame:o,initializeRequestFramework:function(e,n,i){var r=t[e],o=!1;r&&(o=r.initialize(i)),n&&n(o)},getParams:function(e,n){n(t[e].getParams())},showModal:function(e){null===n&&(n=document.createElement("div"),i(n,{position:"fixed","z-index":"2147483646",top:"0px",right:"0px",bottom:"0px",left:"0px","background-color":"rgba(52, 61, 68, 0.6)"})),document.body.appendChild(n)},hideModal:function(){n&&document.body.removeChild(n)},numberOfDialogs:function(){return t?Object.keys(t).length:0}}}();
//# sourceMappingURL=sourcemaps/contentScriptFrame.js.map
