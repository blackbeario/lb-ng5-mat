LPServer=function(){var e,t,r=null,n=null,o=function(e,t){e&&e.error&&e.error(t)},i=(e=function(t,r){t=function(e){var t={};for(var r in e){var n=e[r];if(null!==n&&void 0!==n||(n=""),"object"==typeof n)for(var o in n)n.hasOwnProperty(o)&&(t[r+"["+o+"]"]=n[o]);else t[r]=n}return t}(t),r=r||"";var n=[];for(var o in t){var i=t[o];"object"==typeof i?n=n.concat(e(i,o)):(r&&(o=r+"["+o+"]"),n.push(o+"="+encodeURIComponent(i)))}return n},function(t){return e(t).join("&")}),a=function(e){var t=new XMLHttpRequest,r=e.contentType||"application/x-www-form-urlencoded";e.success&&(t.onload=function(){!function(e,t){if(4===e.readyState)if(200===e.status)switch(t.dataType){case"xml":t.success(e.responseXML,e.responseText);break;case"json":var r=null;try{r=JSON.parse(e.responseText)}catch(e){}t.success(r,e.responseText);break;default:t.success(e.responseText)}else t.error&&t.error(e,e.statusText)}(t,e)}),e.error&&(t.onerror=function(){e.error(t,t.statusText)});var n=function(t){if("application/json"!==r)return i(e.data);if("GET"===t)return"";try{return JSON.parse(e.data),e.data}catch(t){return JSON.stringify(e.data)}},o=e.url;if("GET"===e.type){var a=n(e.type);o=e.url+(a.length>0?"?"+a:"")}if(t.open(e.type||"GET",o,!0),e.headers)for(var u in e.headers)e.headers.hasOwnProperty(u)&&t.setRequestHeader(u,e.headers[u]);"POST"===e.type?(t.setRequestHeader("Content-Type",r),e.beforeSend&&e.beforeSend(t,e),t.send(n())):(e.beforeSend&&e.beforeSend(t,e),t.send())},u=function(e,t){j.ajax({type:"POST",url:j.getBaseURL()+"getCSRFToken.php",success:function(t){e(r=t||null)},error:c(t)})},c=function(e){return function(t,r,n){"function"==typeof e?e():console.error(n)}},s=function(e,t,r,n){f(e,t,r,n)||o(t,r)},f=(t=function(e,t,r,n){if(e){var o=e[r];if("function"==typeof o)return o(n,t),!0}return!1},function(e,r,n,o){var i=t(e,r,n,o);return i=t(r.callbacks,r,n,o)||i}),p=function(e,t){try{j.logException(e)}catch(e){}if(e instanceof A?o(t,e.message):o(t),LPServer.throwExceptions)throw e},l=function(e,t){return function(r,n){try{if(f(e,t,n))return;if(null===r&&n&&"undefined"!=typeof DOMParser)try{r=(new DOMParser).parseFromString(n,"application/xml")}catch(e){}null===r?o(t,"invalidxml"):S(r,e,t)}catch(e){p(e,t)}}},d=function(e,t){return e.getElementsByTagName(t)},y=function(e,t){var r=d(e,t);return r.length>0?r[0]:null},v=function(e,t){var r=y(e,t);return r?r.textContent:""},S=function(e,t,r){var n=y(e,"result"),i=y(e,"ok"),a=y(e,"error"),u=y(e,"failed");if(n){var c=n.getAttribute("rc"),p=n.getAttribute("msg"),l=n.getAttribute("success"),d=n.getAttribute("ok");if(c)return void s(t,r,c,n);if(p)return void s(t,r,p,n);if(l)return void s(t,r,l,n);if(d)return void s(t,r,"ok");var S=n.textContent.trim();if("ok"===S)return void(f(t,r,"ok")||s(t,r,v(e,"status")));if("bad"===S)return void o(r,v(e,"message"))}else{if(i)return void s(t,r,"ok",i);if(a)return void(f(t,r,a.getAttribute("cause"),a)||s(t,r,a.getAttribute("message"),a));if(u)return void s(t,r,u.getAttribute("reason"),u)}o(r)},b=function(e,t){return function(r,n){try{if(null===r&&n)o(t,"invalidjson");else{if(r.error)return void(f(e,t,r.error,r)||o(t,r.errortxt||r.error));if(r.hasOwnProperty("success")){if(r.success&&f(e,t,"success",r))return;if(!r.success)return void o(t)}else if(r.res){if("success"!==r.res)return void(f(e,t,r.res,r)||o(t,r.errortxt));if(f(e,t,r.res,r))return}else{if(f(e,t,r.reason,r))return;if(f(e,t,r.status,r))return;if(f(e,t,r.cmd,r))return}}e&&"function"==typeof e.default?e.default(r,t):"function"==typeof t.success&&t.success(r)}catch(e){p(e,t)}}},g=function(e){e.userSupplied=e.userSupplied||{},e.type=void 0===e.type?"POST":e.type,e.url=j.getBaseURL()+e.url,e.data=T(e.data,e.userSupplied.requestArgs),e.data&&void 0===e.data.lpversion&&"undefined"!=typeof lpversion&&(e.data.lpversion=lpversion),void 0===e.error&&e.userSupplied.error&&(e.error=c(e.userSupplied.error)),!e.data||void 0!==e.data.token||void 0!==e.CSRFToken&&!e.CSRFToken||null!==r?j.ajax(e):u(function(){j.ajax(e)},e.userSupplied.error)},k=function(e,t){var r={},n=t.userSupplied;switch("object"!=typeof n&&(n=t.userSupplied={}),typeof t.success){case"string":return r[t.success]=n.success,e(r,n);case"function":return r.default=t.success,e(r,n);default:if(t.callbacks||n.success||n.callbacks)return e(t.callbacks,n)}return null},x=function(e,t){t.data&&void 0===t.data.token&&(void 0===t.CSRFToken||t.CSRFToken)&&(t.data.token=r)},h=function(e,t,r){for(var n in r=r||[],t){var o=e[n],i=t[n];if("object"==typeof i)h(o,i,r.concat(n));else if(typeof o!==i)throw r.push(n),"Extension is missing the following property: "+r.join(".")+" ("+i+")"}},m=function(e,t,r){var n=e.getAttribute(t);return void 0===n?r:n},T=function(e){e=e||{};for(var t=1,r=arguments.length;t<r;++t){var n=arguments[t];for(var o in n)e[o]=n[o]}return e},_=function(e,t){return e?function(){var r=t.apply(window,arguments);e.apply(window,r||arguments)}:t},R={StringUtils:{translate:"function"},AES:{Encrypt:"function",Decrypt:"function",hex2bin:"function",bin2hex:"function"},enc:"function",dec:"function",RSAKey:"function",createRandomHexString:"function",parse_public_key:"function",parse_private_key:"function",enccbc:"function",make_lp_key_iterations:"function",make_lp_hash_iterations:"function",get_random_password:"function"},w={RSAKey:!0},j={ajax:a,translate:function(){return n.StringUtils.translate.apply(n.StringUtils,arguments)},logException:function(){},hex2bin:function(){return n.AES.hex2bin.apply(n.AES,arguments)},bin2hex:function(){return n.AES.bin2hex.apply(n.AES,arguments)},encryptAES:function(e,t){return n.enc(e,t)},decryptAES:function(e,t){return n.dec(e,t)},encrypt:function(e,t){return n.enc(e,t)},decrypt:function(e,t){try{return n.dec(e,t)}catch(e){return""}},createRandomHexString:function(){return n.createRandomHexString.apply(n,arguments)},parsePublicKey:function(){return n.parse_public_key.apply(n,arguments)},parsePrivateKey:function(e,t){if(!(t=t||n.rsaprivatekeyhex))throw"rsaprivatekeyhex required for this action.";return n.parse_private_key(e,t)},extractPrivateKey:function(e,t){return n.rsa_extract_privatekey(e,t)},encryptCBC:function(){return n.enccbc.apply(n,arguments)},makeKey:function(){return n.make_lp_key_iterations.apply(n,arguments)},makeHash:function(){return n.make_lp_hash_iterations.apply(n,arguments)},makeRandomPassword:function(){return n.get_random_password.apply(n,arguments)},getBaseURL:function(){return n.base_url||""},getLocalKey:function(){return n.g_local_key},setLocalKey:function(e){n.g_local_key=e}},A=function(e){this.message=e,this.stack=(new Error).stack};A.prototype=Object.create(Error.prototype),A.prototype.name="ClientException",A.prototype.constructor=A;var E,C=(E=function(e){e.setRequestHeader("X-CSRF-TOKEN",r)},{jsonRequest:function(e){var t,r;e.dataType="json",e.contentType="application/json",e.beforeSend=_(e.beforeSend,E),e.error=(t=e.callbacks,r=e.userSupplied||{},function(e,n){var i;try{i=JSON.parse(e.responseText)}catch(e){return void o(r,"invalidjson")}f(t,r,i.code,i)||o(r,i.message)}),g(e)}});return{ajax:a,getRecordsFromResponse:function(e,t,r){for(var n=[],o=0;o<r;++o)n.push(m(e,t+o));return n},jsonRequest:function(e){e.dataType="json",e.beforeSend=_(e.beforeSend,x),e.success=k(b,e),g(e)},xmlRequest:function(e){e.dataType="xml",e.beforeSend=_(e.beforeSend,x),e.success=k(l,e),g(e)},textRequest:function(e){e.dataType="text",e.beforeSend=_(e.beforeSend,x),g(e)},initialize:function(e,t){for(var r in h(e,R),t)j[r]=t[r];for(var o in w)j[o]=e[o];n=e},ext:j,getNodes:d,getNode:y,getNodeText:v,getAttr:m,getAttrInt:function(e,t,r){var n=parseInt(m(e,t,r));return isNaN(n)?r:n},extend:T,extendCallback:_,ClientException:A,clearCSRFToken:function(){r=null},getCSRFToken:u,callback:function(e,t){e.callbacks&&"function"==typeof e.callbacks[t]&&e.callbacks[t].apply(window,Array.prototype.slice.call(arguments,2))},lmiapi:C}}();
//# sourceMappingURL=sourcemaps/newserver.js.map
