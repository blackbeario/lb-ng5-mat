function get_SAED_username_password_fields(e,n){if(!e)return[];n||(n={});var s=[],a=getBG(),l=null,r=null,t=!1;if(!e.save_all||!e.fields||0===e.fields.length)return[getusernamefromacct(e),getpasswordfromacct(e)];var f,i=[[50,50],[-50,-50],[-5,25],[5,-25],[10,-10],[-5,10],[5,-10],[-30,-30],[7,7],[1,-10],[-20,-20],[-20,-20]],d=null,E=null,_=new RegExp(get_ff_translation("ff_username_regexp")),p=new RegExp(get_ff_translation("ff_password_regexp")),o=new RegExp(get_ff_translation("ff_email_regexp")),u=new RegExp(get_ff_translation("ff_captcha_regexp")),R=new RegExp(get_ff_translation("ff_combineddummy_regexp")),m=new RegExp(get_ff_translation("ff_search_regexp")),O=[],S=e.fields.length;for(f=0;f<S;f++)O[f]={USCORE:0,PSCORE:0};for(f=0;f<S;f++){var C=e.fields[f].type,g=e.fields[f].value,c=e.fields[f].name;null!==g&&""!==g||(w(sprintf("[%d] %s VALUE:EMPTY",f,e.fields[f].name)),O[f].USCORE+=i[1][0],O[f].PSCORE+=i[1][1]),_.exec(c)&&(w(sprintf("[%d] %s NAME:USERNAME",f,e.fields[f].name)),O[f].USCORE+=i[4][0],O[f].PSCORE+=i[4][1]),p.exec(c)&&(w(sprintf("[%d] %s NAME:PASSWORD",f,e.fields[f].name)),O[f].USCORE+=i[5][0],O[f].PSCORE+=i[5][1]),o.exec(c)&&(w(sprintf("[%d] %s NAME:EMAIL",f,e.fields[f].name)),O[f].USCORE+=i[6][0],O[f].PSCORE+=i[6][1]),(u.exec(c)||R.exec(c)||m.exec(c))&&(w(sprintf("[%d] %s NAME:IGNORE",f,e.fields[f].name)),O[f].USCORE+=i[7][0],O[f].PSCORE+=i[7][1]),"password"==C?(w(sprintf("[%d] %s TYPE:PW_TYPE",f,e.fields[f].name)),null===r&&(O[f].PSCORE+=i[8][1],r=f),O[f].USCORE+=i[2][0],O[f].PSCORE+=i[2][1]):lp_in_array(C,["text","tel","email","url"])?(w(sprintf("[%d] %s TYPE:TEXT_TYPE",f,e.fields[f].name)),null===l&&(O[f].USCORE+=i[8][0],l=f),O[f].USCORE+=i[3][0],O[f].PSCORE+=i[3][1]):lp_in_array(C,["number"])?(w(sprintf("[%d] %s TYPE:HTML5TEXTISH",f,e.fields[f].name)),O[f].USCORE+=i[9][0],O[f].PSCORE+=i[9][1]):lp_in_array(C,["date","month","color","datetime","search","range","time","datetime-local","week"])?(w(sprintf("[%d] %s TYPE:HTML5NONTEXTISH",f,e.fields[f].name)),O[f].USCORE+=i[10][0],O[f].PSCORE+=i[10][1]):lp_in_array(C,["reset","button","image","file","submit"])&&(w(sprintf("[%d] %s TYPE:HTML4NONTEXTISH",f,e.fields[f].name)),O[f].USCORE+=i[11][0],O[f].PSCORE+=i[11][1]),"j_username"===c?d=f:"j_password"===c&&"password"==C&&(E=f)}null!==d&&null!==E&&(O[d].USCORE+=i[0][0],O[E].PSCORE+=i[0][1]);var P=0,U=-1/0,x=0,T=-1/0;for(f=0;f<S;f++)w(sprintf("FIELD %d name=%s U=%d/P=%d",f,e.fields[f].name,O[f].USCORE,O[f].PSCORE)),O[f].USCORE>U&&(U=O[f].USCORE,P=f),O[f].PSCORE>T&&(T=O[f].PSCORE,x=f);P===x&&S>1&&w("EDGE CASE TODO"),s=[];var v="";return null===(v=is_encrypted_field(e.fields[P].type)?a.lpmdec_acct(e.fields[P].value,!0,e,a.g_shares):e.fields[P].value)&&(v=""),w(sprintf("username: guessed %s/%s",e.fields[P].name,v)),s.push(v),null===(v=is_encrypted_field(e.fields[x].type)?a.lpmdec_acct(e.fields[x].value,!0,e,a.g_shares):e.fields[x].value)&&(v=""),w(sprintf("password: guessed %s/%s",e.fields[x].name,g_show_pw_in_logs?v:"<REDACTED>")),s.push(v),s;function w(e){t&&console_log(e)}}function value_is_masked(e,n){if(!e||"string"!=typeof e)return!1;var s=encodeURIComponent(e);return e.indexOf("***")>=0||s.indexOf("%E2%80%A2%E2%80%A2%E2%80%A2")>=0}function formdata_has_masked_values(e){if(!e)return!1;for(var n=void 0!==e?e.split("\n"):new Array,s=0;s<n.length;s++){var a=n[s].split("\t");if(4==a.length||5==a.length){decodeURIComponent(a[1]);var l=decodeURIComponent(a[2]),r=decodeURIComponent(a[4]);if(value_is_masked(l)&&"notseen"!=r)return console_warn("detected masked field value: "+l),!0}}return!1}
//# sourceMappingURL=sourcemaps/heuristics_bg.js.map
